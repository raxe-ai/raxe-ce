version: 1.0.0
rule_id: cmd-022
family: CMD
sub_family: sql_injection
name: Detects SQL WAITFOR DELAY time-based injection
description: Detects SQL WAITFOR DELAY time-based injection
severity: critical
confidence: 0.97
patterns:
- pattern: (?i)'\s*WAITFOR\s+DELAY\s+['"]\d+
  flags:
  - IGNORECASE
  timeout: 5.0
- pattern: '(?i)WAITFOR\s+TIME\s+[''"]\d{2}:'
  flags:
  - IGNORECASE
  timeout: 5.0
- pattern: (?i)';?\s*WAITFOR\s+DELAY\s*['"]\d+:\d+:\d+
  flags:
  - IGNORECASE
  timeout: 5.0
examples:
  should_match:
  - admin' WAITFOR DELAY '00:00:10'--
  - 1'; WAITFOR DELAY '0:0:5'--
  - user' WAITFOR TIME '14:00:00'--
  should_not_match:
  - SQL Server WAITFOR documentation
  - How to use WAITFOR in stored procedures
  - Time delays in T-SQL explained
metrics:
  precision: null
  recall: null
  f1_score: null
  last_evaluated: null
mitre_attack:
- T1059
metadata:
  created: '2025-11-09'
  updated: '2025-11-09'
  author: raxe-ce
  legacy_rx_id: RX-CMD-0022
rule_hash: sha256:e75f179274a7d056e3436ed63cc1c821b5f1d3454ddb9d1d320ae9316bc36b95
risk_explanation: SQL injection attacks inject malicious SQL commands to manipulate database queries, enabling data theft, unauthorized modifications, or complete database compromise. Critical commands like DROP, DELETE, and TRUNCATE can cause catastrophic data loss.
remediation_advice: Always use parameterized queries and prepared statements. Never concatenate user input into SQL commands. Implement input validation and sanitization. Use database accounts with minimal required privileges. Deploy SQL injection detection and blocking at multiple layers.
docs_url: https://github.com/raxe-ai/raxe-ce/wiki/CMD-022-Sql-Waitfor-Delay
