{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://raxe.ai/schemas/v1.0.0/identity/jwt_token.json",
  "title": "RAXE JWT Token Claims",
  "description": "JWT token claims structure for authentication and authorization",
  "type": "object",
  "required": ["iss", "sub", "iat", "exp", "tenant_id", "scopes"],
  "properties": {
    "iss": {
      "type": "string",
      "const": "https://api.raxe.ai",
      "description": "Token issuer (RAXE API)"
    },
    "sub": {
      "type": "string",
      "description": "Subject - user_id or service account identifier"
    },
    "aud": {
      "type": "string",
      "const": "raxe-api",
      "description": "Intended audience"
    },
    "iat": {
      "type": "integer",
      "minimum": 0,
      "description": "Issued at timestamp (Unix epoch)"
    },
    "exp": {
      "type": "integer",
      "minimum": 0,
      "description": "Expiration timestamp (Unix epoch)"
    },
    "nbf": {
      "type": "integer",
      "minimum": 0,
      "description": "Not before timestamp (Unix epoch)"
    },
    "jti": {
      "type": "string",
      "format": "uuid",
      "description": "JWT ID - unique token identifier"
    },
    "tenant_id": {
      "type": "string",
      "pattern": "^org-[a-z0-9]{16}$",
      "description": "Organization identifier for multi-tenancy"
    },
    "project_id": {
      "type": "string",
      "pattern": "^proj-[a-z0-9]{16}$",
      "description": "Project identifier (optional, for project-scoped tokens)"
    },
    "environment": {
      "type": "string",
      "enum": ["local", "development", "staging", "production", "custom"],
      "description": "Deployment environment"
    },
    "scopes": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "string",
        "enum": [
          "events:write",
          "events:read",
          "rules:read",
          "rules:write",
          "policies:read",
          "policies:write",
          "projects:read",
          "projects:write",
          "admin:read",
          "admin:write",
          "billing:read",
          "billing:write"
        ]
      },
      "description": "Granted permissions"
    },
    "user_id": {
      "type": "string",
      "description": "User identifier (if user token, not service account)"
    },
    "email": {
      "type": "string",
      "format": "email",
      "description": "User email (if user token)"
    },
    "role": {
      "type": "string",
      "enum": ["owner", "admin", "developer", "viewer", "service_account"],
      "description": "User role within organization"
    },
    "api_key_id": {
      "type": "string",
      "pattern": "^key-[a-z0-9]{16}$",
      "description": "Associated API key ID (if token generated from API key)"
    },
    "session_id": {
      "type": "string",
      "format": "uuid",
      "description": "Session identifier for tracking user sessions"
    },
    "ip_address": {
      "type": "string",
      "pattern": "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$",
      "description": "IP address where token was issued (for audit)"
    },
    "metadata": {
      "type": "object",
      "additionalProperties": true,
      "description": "Additional custom claims"
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "iss": "https://api.raxe.ai",
      "sub": "user-abc123",
      "aud": "raxe-api",
      "iat": 1699564800,
      "exp": 1699651200,
      "nbf": 1699564800,
      "jti": "550e8400-e29b-41d4-a716-446655440000",
      "tenant_id": "org-3f8a9b2c1d5e6f7a",
      "project_id": "proj-a1b2c3d4e5f6g7h8",
      "environment": "production",
      "scopes": ["events:write", "events:read", "rules:read"],
      "user_id": "user-abc123",
      "email": "developer@example.com",
      "role": "developer",
      "api_key_id": "key-1234567890abcdef"
    }
  ]
}
