{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://raxe.ai/schemas/v1.2.0/ml/l2_prediction.json",
  "title": "L2 ML Prediction Output",
  "type": "object",
  "required": ["predictions", "confidence", "processing_time_ms", "model_version"],
  "properties": {
    "predictions": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/prediction"
      }
    },
    "confidence": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Overall confidence in analysis"
    },
    "processing_time_ms": {
      "type": "number",
      "minimum": 0,
      "description": "Inference time in milliseconds"
    },
    "model_version": {
      "type": "string",
      "pattern": "^v[0-9]+\\.[0-9]+\\.[0-9]+$",
      "description": "Model version identifier"
    },
    "features_extracted": {
      "type": "object",
      "description": "Features used for prediction"
    },
    "metadata": {
      "type": "object",
      "properties": {
        "model_type": {"type": "string"},
        "device": {"type": "string", "enum": ["cpu", "cuda", "mps"]},
        "batch_size": {"type": "integer", "minimum": 1}
      }
    }
  },
  "definitions": {
    "prediction": {
      "type": "object",
      "required": ["threat_type", "confidence"],
      "properties": {
        "threat_type": {
          "type": "string",
          "enum": [
            "semantic_jailbreak",
            "encoded_injection",
            "context_manipulation",
            "privilege_escalation",
            "data_exfil_pattern",
            "obfuscated_command",
            "unknown"
          ]
        },
        "confidence": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0
        },
        "explanation": {
          "type": "string",
          "maxLength": 100,
          "description": "Human-readable explanation (<100 chars)"
        },
        "features_used": {
          "type": "array",
          "items": {"type": "string"}
        }
      }
    }
  }
}