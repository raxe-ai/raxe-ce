version: 1.0.0
rule_id: cmd-036
family: CMD
sub_family: shell_commands
name: Detects command chaining with semicolon for destructive commands
description: Detects command chaining with semicolon for destructive commands
severity: critical
confidence: 0.98
patterns:
- pattern: (?i);\s*(?:rm|del|format)\s+(?:-[rf]+|(?:/[a-z]\s*)+)
  flags:
  - IGNORECASE
  timeout: 5.0
- pattern: (?i);\s*shutdown\s+(?:-[hrsp]|/[srp])
  flags:
  - IGNORECASE
  timeout: 5.0
- pattern: (?i);\s*(?:mkfs|dd\s+if=)
  flags:
  - IGNORECASE
  timeout: 5.0
examples:
  should_match:
  - ; rm -rf /
  - ; del /f /s /q C:\
  - ; shutdown -r now
  - ; mkfs.ext4 /dev/sda1
  should_not_match:
  - Command chaining in bash scripts
  - How to use semicolon in shell
  - Shutdown command for maintenance
metrics:
  precision: null
  recall: null
  f1_score: null
  last_evaluated: null
mitre_attack:
- T1059
metadata:
  created: '2025-11-09'
  updated: '2025-11-09'
  author: raxe-ce
  legacy_rx_id: RX-CMD-0036
rule_hash: sha256:9e54a0d1dcaab2b37a92cc57d252ec0e7cf87154d2781db6b3a57703784914be
risk_explanation: Shell command injection exploits enable arbitrary system command execution through vulnerable inputs. Attackers can read sensitive files, modify system configurations, escalate privileges, install backdoors, or completely compromise the underlying system.
remediation_advice: Never execute shell commands with user-controlled input. If command execution is necessary, use strict allowlisting of permitted commands and arguments. Implement input validation and sanitization. Use least-privilege execution contexts. Deploy command injection detection.
docs_url: https://github.com/raxe-ai/raxe-ce/wiki/CMD-036-Command-Chaining
