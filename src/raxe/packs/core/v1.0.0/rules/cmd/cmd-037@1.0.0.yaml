version: 1.0.0
rule_id: cmd-037
family: CMD
sub_family: shell_commands
name: Detects pipe-based command injection for data extraction
description: Detects pipe-based command injection for data extraction
severity: critical
confidence: 0.97
patterns:
- pattern: \|\s*(?:cat|type|more|less)\s+(?:/etc/|C:\\)
  flags: []
  timeout: 5.0
- pattern: \|\s*grep\s+-r\s+['"]password
  flags: []
  timeout: 5.0
- pattern: \|\s*find\s+/\s+-name\s+['"]\*pass
  flags: []
  timeout: 5.0
examples:
  should_match:
  - '| cat /etc/passwd'
  - '| grep -r "password" /etc'
  - '| find / -name "*password*"'
  - '| type C:\Windows\System32\config\SAM'
  should_not_match:
  - Using pipes in Linux commands
  - How to grep for patterns
  - Find command syntax tutorial
metrics:
  precision: null
  recall: null
  f1_score: null
  last_evaluated: null
mitre_attack:
- T1059
metadata:
  created: '2025-11-09'
  updated: '2025-11-09'
  author: raxe-ce
  legacy_rx_id: RX-CMD-0037
rule_hash: sha256:25e6bd3713ab441388eaec8d00c8fb50a391a66fc7cf1536cd0aca695515cbc3
risk_explanation: Shell command injection exploits enable arbitrary system command execution through vulnerable inputs. Attackers can read sensitive files, modify system configurations, escalate privileges, install backdoors, or completely compromise the underlying system.
remediation_advice: Never execute shell commands with user-controlled input. If command execution is necessary, use strict allowlisting of permitted commands and arguments. Implement input validation and sanitization. Use least-privilege execution contexts. Deploy command injection detection.
docs_url: https://github.com/raxe-ai/raxe-ce/wiki/CMD-037-Pipe-Based-Command-Injection
