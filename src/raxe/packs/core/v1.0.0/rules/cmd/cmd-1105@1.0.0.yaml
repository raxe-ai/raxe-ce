version: 1.0.0
rule_id: cmd-1105
family: CMD
sub_family: network_tools
name: Detects nmap for network scanning
description: Detects nmap for network scanning
severity: high
confidence: 0.95
patterns:
- pattern: \bnmap\s+(-[^\s]+\s+)*\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}
  flags: []
  timeout: 5.0
- pattern: \bnmap\s+(-[^\s]+\s+)*-p\s*\d+
  flags: []
  timeout: 5.0
- pattern: \bnmap\s+(-[^\s]+\s+)*-sV
  flags: []
  timeout: 5.0
examples:
  should_match:
  - nmap -sS 192.168.1.1
  - nmap -p 22,80,443 10.0.0.1
  - nmap -sV target.com
  should_not_match:
  - nmap network scanning tutorial
  - Port scanning basics
  - Network reconnaissance guide
metrics:
  precision: null
  recall: null
  f1_score: null
  last_evaluated: null
metadata:
  created: '2025-11-09'
  updated: '2025-11-09'
  author: raxe-ce
  legacy_rx_id: RX-CMD-1105
rule_hash: sha256:74be22629afd8399a0b6f9b9739b2a9e7f93361cba9999166f22f88dedacfe4e
risk_explanation: Network tool abuse (curl, wget, nmap, netcat) enables data exfiltration, network reconnaissance, port scanning, or establishing backdoor connections. These tools can be weaponized to map infrastructure, steal data, or facilitate lateral movement.
remediation_advice: Restrict network access from AI systems to only required services. Implement egress filtering and network segmentation. Use allowlisting for permitted network destinations. Monitor for suspicious network tool usage and data exfiltration patterns.
docs_url: https://github.com/raxe-ai/raxe-ce/wiki/CMD-1105-Nmap-Network
