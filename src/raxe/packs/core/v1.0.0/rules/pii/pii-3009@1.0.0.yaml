version: 1.0.0
rule_id: pii-3009
family: PII
sub_family: api_keys
name: Stripe API Key Detection
description: Detects Stripe API keys (sk_live_, pk_live_, sk_test_, pk_test_ patterns)
severity: critical
confidence: 0.99
patterns:
- pattern: \b(sk_live_[0-9a-zA-Z]{24,})\b
  flags: []
  timeout: 5.0
- pattern: \b(pk_live_[0-9a-zA-Z]{24,})\b
  flags: []
  timeout: 5.0
- pattern: \b(sk_test_[0-9a-zA-Z]{24,})\b
  flags: []
  timeout: 5.0
examples:
  should_match:
  - "STRIPE_SECRET_KEY=sk_live_1234567890abcdefghijklmnopqrstuvwxyz"
  - "publishable_key: pk_live_AAAAAAAAAAAAAAAAAAAAAAAAAAAA"
  - "test_key=sk_test_abcdefghijklmnopqrstuvwxyz1234567890"
  should_not_match:
  - "Stripe keys start with sk_live_ or pk_live_"
  - "How to get Stripe API keys?"
metrics:
  precision: null
  recall: null
  f1_score: null
  last_evaluated: null
mitre_attack:
- T1552.001
metadata:
  created: '2025-11-16'
  updated: '2025-11-16'
  author: raxe-ce
  category: payment_credentials
rule_hash: null
